{"version":3,"sources":["customers/customers-detail.controller.ts"],"names":["outlookApp","outlookApp.customers","outlookApp.customers.CustomerDetailController","outlookApp.customers.CustomerDetailController.constructor","outlookApp.customers.CustomerDetailController.loadCustomer","outlookApp.customers.CustomerDetailController.goBack"],"mappings":"AAAA,wDAAwD;AACxD,wDAAwD;AAExD,IAAO,UAAU,CA8DhB;AA9DD,WAAO,UAAU;IAACA,IAAAA,SAASA,CA8D1BA;IA9DiBA,WAAAA,SAASA,EAACA,CAACA;QAC3BC,YAAYA,CAACA;QAEbA,IAAMA,wBAAwBA;YAK5BC;;;;;;;eAOGA;YACHA,SAbIA,wBAAwBA,CAaRA,EAAeA,EACfA,OAAyBA,EACzBA,SAA6BA,EAC7BA,YAAsDA,EACtDA,eAAmDA;gBAJnDC,OAAEA,GAAFA,EAAEA,CAAaA;gBACfA,YAAOA,GAAPA,OAAOA,CAAkBA;gBACzBA,cAASA,GAATA,SAASA,CAAoBA;gBAC7BA,iBAAYA,GAAZA,YAAYA,CAA0CA;gBACtDA,oBAAeA,GAAfA,eAAeA,CAAoCA;gBAhBvEA,aAAQA,GAAkCA,EAAEA,CAACA;gBAkB3CA,AACAA,oCADoCA;oBAChCA,UAAUA,GAAGA,YAAYA,CAACA,UAAUA,CAACA;gBACzCA,EAAEA,CAACA,CAACA,UAAUA,CAACA,CAACA,CAACA;oBACfA,IAAIA,CAACA,YAAYA,CAACA,UAAUA,CAACA,CAACA;gBAChCA,CAACA;gBAACA,IAAIA,CAACA,CAACA;oBACNA,IAAIA,CAACA,SAASA,CAACA,IAAIA,CAACA,GAAGA,CAACA,CAACA;gBAC3BA,CAACA;YACHA,CAACA;YAEDD;;;;eAIGA;YACHA,+CAAYA,GAAZA,UAAaA,UAAUA;gBAAvBE,iBAaCA;gBAZCA,IAAIA,QAAQA,GAAGA,IAAIA,CAACA,EAAEA,CAACA,KAAKA,EAAEA,CAACA;gBAE/BA,IAAIA,CAACA,eAAeA,CAACA,cAAcA,CAACA,UAAUA,CAACA,CAC5CA,IAAIA,CAACA,UAACA,QAAQA;oBACbA,KAAIA,CAACA,QAAQA,GAAGA,QAAQA,CAACA;oBACzBA,QAAQA,CAACA,OAAOA,EAAEA,CAACA;gBACrBA,CAACA,CAACA,CACDA,KAAKA,CAACA,UAACA,KAAKA;oBACXA,QAAQA,CAACA,MAAMA,CAACA,KAAKA,CAACA,CAACA;gBACzBA,CAACA,CAACA,CAACA;gBAELA,MAAMA,CAACA,QAAQA,CAACA,OAAOA,CAACA;YAC1BA,CAACA;YAEDF;;eAEGA;YACHA,yCAAMA,GAANA;gBACEG,IAAIA,CAACA,OAAOA,CAACA,OAAOA,CAACA,IAAIA,EAAEA,CAACA;YAC9BA,CAACA;YAlDMH,gCAAOA,GAAGA,CAACA,IAAIA,EAAEA,SAASA,EAAEA,WAAWA,EAAEA,cAAcA,EAAEA,qCAAqCA,CAACA,CAACA;YAoDzGA,+BAACA;QAADA,CAvDAD,AAuDCC,IAAAD;QAEDA,AACAA,0BAD0BA;QAC1BA,OAAOA,CAACA,MAAMA,CAACA,YAAYA,CAACA,CAACA,UAAUA,CAACA,gDAAgDA,EAAEA,wBAAwBA,CAACA,CAACA;IACtHA,CAACA,EA9DiBD,SAASA,GAATA,oBAASA,KAATA,oBAASA,QA8D1BA;AAADA,CAACA,EA9DM,UAAU,KAAV,UAAU,QA8DhB","file":"customers/customers-detail.controller.js","sourceRoot":"/Users/ac/repos/pres-o365-node/officeaddin-outlook/","sourcesContent":["/// <reference path=\"../../../tools/typings/tsd.d.ts\" />\n/// <reference path=\"../../../tools/typings/app.d.ts\" />\n\nmodule outlookApp.customers {\n  'use strict';\n\n  class CustomerDetailController {\n    customer:outlookApp.customers.ICustomer = {};\n\n    static $inject = ['$q', '$window', '$location', '$routeParams', 'outlookApp.services.customerService'];\n\n    /**\n     * Controller constructor\n     * @param $q                Angular's $q promise service.\n     * @param $window           Angular's $window service.\n     * @param $location         Angular's $location service.\n     * @param $routeParams      Angular's $routeParams service.\n     * @param customerService   Custom Angular service for customer data.\n     */\n    constructor(private $q:ng.IQService,\n                private $window:ng.IWindowService,\n                private $location:ng.ILocationService,\n                private $routeParams:outlookApp.customers.ICustomerRouteParams,\n                private customerService:outlookApp.services.CustomerService) {\n\n      // if ID is passed in, load customer\n      var customerId = $routeParams.customerID;\n      if (customerId) {\n        this.loadCustomer(customerId);\n      } else {\n        this.$location.path('/');\n      }\n    }\n\n    /**\n     * Load the specified customer.\n     *\n     * @param customerID {number}   ID of the selected customer to display.\n     */\n    loadCustomer(customerID) {\n      var deferred = this.$q.defer();\n\n      this.customerService.lookupCustomer(customerID)\n        .then((customer) => {\n          this.customer = customer;\n          deferred.resolve();\n        })\n        .catch((error) => {\n          deferred.reject(error);\n        });\n\n      return deferred.promise;\n    }\n\n    /**\n     * Navigates back to the list.\n     */\n    goBack() {\n      this.$window.history.back();\n    }\n\n  }\n\n  // register the controller\n  angular.module('outlookApp').controller('outlookApp.customers.customersDetailController', CustomerDetailController);\n}"]}